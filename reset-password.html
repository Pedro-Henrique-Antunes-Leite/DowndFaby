<div
  style="
    font-family: 'Segoe UI', system-ui, sans-serif;
    font-size: 15px;
    color: #e0e0e0;
    padding: 24px;
    background-color: #0a0a0a;
  "
>
  <div style="max-width: 600px; margin: auto; background-color: #1a1a1a; border-radius: 12px; overflow: hidden;">
    <div style="text-align: center; background: linear-gradient(90deg, #6f00ff, #00c3ff); padding: 16px;">
      <h2 style="margin: 0; color: #fff;">DowndFaby Web</h2>
    </div>
    <div style="padding: 24px;">
      <h1 style="font-size: 22px; color: #ffffff; margin-bottom: 20px;">üîê Pedido de redefini√ß√£o de senha</h1>
      <p style="margin-bottom: 16px;">
        Recebemos uma solicita√ß√£o para redefinir a senha da sua conta. Para continuar, clique no bot√£o abaixo:
      </p>
      <p style="margin-bottom: 20px;">
        <a
          href="{{link}}"
          style="
            display: inline-block;
            padding: 12px 20px;
            background: linear-gradient(90deg, #6f00ff, #00c3ff);
            color: #fff;
            text-decoration: none;
            border-radius: 8px;
            font-weight: bold;
            box-shadow: 0 0 12px #6f00ff;
          "
        >
          Redefinir senha
        </a>
      </p>
      <p style="margin-bottom: 16px;">‚ö†Ô∏è Este link expira em 1 hora.</p>
      <p style="margin-bottom: 16px;">
        Se voc√™ n√£o solicitou essa redefini√ß√£o, ignore este email ou entre em contato conosco imediatamente.
      </p>
      <p>Atenciosamente,<br /><strong style="color: #6f00ff;">Equipe DowndFaby</strong></p>
    </div>
  </div>
  <div style="max-width: 600px; margin: auto; text-align: center; padding: 16px; font-size: 13px; color: #777;">
    Este email foi enviado para {{email}}<br />
    Voc√™ recebeu este email porque est√° registrado no DowndFaby.
  </div>
</div>
<!-- Coloque isso no final do seu HTML ou dentro de <script> -->
<script>
  document.addEventListener('DOMContentLoaded', () => {
    const form = document.createElement('form');
    form.id = 'reset-form';
    form.style = 'margin-top: 32px; text-align: center;';

    form.innerHTML = `
      <input type="password" id="new-password" placeholder="Nova senha" required
        style="padding: 10px; margin: 8px; border-radius: 6px; border: none; width: 80%; max-width: 300px;">
      <br>
      <input type="password" id="confirm-password" placeholder="Confirmar senha" required
        style="padding: 10px; margin: 8px; border-radius: 6px; border: none; width: 80%; max-width: 300px;">
      <br>
      <button type="submit"
        style="padding: 12px 24px; background: linear-gradient(90deg, #6f00ff, #00c3ff); color: white; border: none; border-radius: 8px; font-weight: bold; box-shadow: 0 0 12px #6f00ff; cursor: pointer;">
        Redefinir Senha
      </button>
      <p id="feedback" style="margin-top: 16px;"></p>
    `;

    document.body.appendChild(form);

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const password = document.getElementById('new-password').value;
      const confirm = document.getElementById('confirm-password').value;
      const feedback = document.getElementById('feedback');
      const token = new URLSearchParams(window.location.search).get('token');

      // Valida√ß√£o
      if (!token) {
        feedback.textContent = 'Token inv√°lido ou ausente.';
        feedback.style.color = 'red';
        return;
      }

      if (password.length < 8) {
        feedback.textContent = 'A senha deve ter pelo menos 8 caracteres.';
        feedback.style.color = 'red';
        return;
      }

      if (password !== confirm) {
        feedback.textContent = 'As senhas n√£o coincidem.';
        feedback.style.color = 'red';
        return;
      }

      // Envio seguro
      try {
        const response = await fetch('https://downdfaby-api.vercel.app/reset-password', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ token, password })
        });

        const result = await response.json();

        if (response.ok) {
          feedback.textContent = 'Senha redefinida com sucesso!';
          feedback.style.color = 'limegreen';
        } else {
          feedback.textContent = result.message || 'Erro ao redefinir senha.';
          feedback.style.color = 'red';
        }
      } catch (error) {
        feedback.textContent = 'Erro de conex√£o. Tente novamente.';
        feedback.style.color = 'red';
      }
    });
  });
</script>